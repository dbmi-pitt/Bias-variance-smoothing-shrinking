
Dr. Who is not confident in either Dr. Split or Dr. Lump.  Maybe one’s right ($\phi  = Split$ ), maybe the other ( $\phi  = Lump$). Here is a prior that might represent this view:;

\[\pi _{Who}^{}({\bf{p}}) = \pi _{Who}^{}(\phi  = Split)\pi _{Split}^{}({\bf{p}}) + \pi _{Who}^{}(\phi  = Lump)\pi _{Lump}^{}({\bf{p}}).\]
 
NOTE: This marginalizes out (sums over) the nuisance parameter $\phi$ over the joint distribution of ( ${p_{R.D}},\phi$)!

Then Dr. Who’s posterior is:
 \[\pi _{Who}^*({p_{R.D}}) = \pi _{Who}^*(\phi  = Split)\pi _{Split}^*({p_{R.D}}) + \pi _{Who}^*(\phi  = Lump)\pi _{Lump}^*({p_{R.D}})\]
 
where
 \[\pi _{Who}^*(\phi  = Split) = \frac{{\pi (Split){m_{Split}}}}{{\pi (Split){m_{Split}} + \pi (Lump){m_{Lump}}}},\]
and the $m$ values are the respective marginal distributions of the data  $({n_{RD}},{n_{RL}},{n_{ND}},{n_{NL}})$ if you knew $\phi$ but not the parameters  --  conditional $\phi$ and marginal over ${p_{R.D}}$.  

```{r}
TextQuestion("If Dr. Who gives Dr. Lump and Dr. Split equal weight BEFORE seeing the data, is this still true AFTER seeing the data?
")
```

###### calculation of the Bayes factor, and plotting the mixture.

If *Split* is correct, then the (marginal) probability of getting the data we observed is:
`r output$mSplit = renderText({
  options(digits=3); 
  mSplit(); 
  textOutput('mSplit')
  })
  `.


```{r}
conditionalPanelWithCheckbox(
  labelString = 'equations for Dr. Split\'s marginal probability', 
  filename = 'DrSplitEquation.Rmd',
  html='',
  initialValue=FALSE
)
```

If *Lump* is correct, then the (marginal) probability of getting the data we observed is:
`r output$mLump = renderText({
  options(digits=3); 
  mLump(); 
  textOutput('mLump')})`.
  
```{r}
conditionalPanelWithCheckbox(
  labelString = 'equations for Dr. Lump\'s marginal probability', 
  filename = 'DrLumpEquation.Rmd',
  html='',
  initialValue=FALSE
)
```

Here is the code if you are interested:

```{r}
conditionalPanelWithCheckbox(
  labelString = 'code for the Lump and Split marginal probabilities',
  html=
    div(
              HTML(gsub('  ', '&nbsp;&nbsp;',
                        paste(readLines(con='DrWhoBayesFactor.R'),
                    collapse='<br>\n')))
  ),
  initialValue=FALSE
)
```

###### Bayes Factor, Posterior odds (and probability) of the "null hypothesis"

The  Bayes Factor is the ratio
\[{m_{Split}}/{m_{Lump}} \], 
and also the ratio of posterior odds to prior odds.

If *Dr.Split* and *Dr.Lump* have equal prior probability (prior odds = 1),
then the posterior odds is the Bayes factor,
and  the posterior probability that *Dr.Lump* is right is

\[{\rm{Pr(}}\phi  = Lump|data) = {m_{Lump}}/({m_{Split}} + {m_{Lump}})\]

Then Dr. Who's estimate is 

$\begin{array}{l}
\Pr (R|D,Who) = \Pr (Lump) \times \Pr (R|D,Lump) + \Pr (Split) \times \Pr (R|D,Split)\\
\quad \quad \quad \quad \quad \quad \quad  = 0.05\quad \quad \quad  \times 0.08\quad \quad \quad \quad \quad \quad  + 0.95\quad \quad \quad  \times 0.60\\
\quad \quad \quad \quad \quad \quad \quad  = {\rm{ 0.574}}
\end{array}$
